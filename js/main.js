var lunarMonthTable = [
    [2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 2, 5, 2, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1],   /* 1901 */
    [2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2],
    [1, 2, 1, 2, 3, 2, 1, 1, 2, 2, 1, 2],
    [2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1],
    [2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2],
    [1, 2, 2, 4, 1, 2, 1, 2, 1, 2, 1, 2],
    [1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1],
    [2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2],
    [1, 5, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1],
    [2, 1, 2, 1, 1, 5, 1, 2, 2, 1, 2, 2],   /* 1911 */
    [2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2],
    [2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2],
    [2, 2, 1, 2, 5, 1, 2, 1, 2, 1, 1, 2],
    [2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2],
    [1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1],
    [2, 3, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1],
    [2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 5, 2, 2, 1, 2, 2],
    [1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2],
    [2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2],   /* 1921 */
    [2, 1, 2, 2, 3, 2, 1, 1, 2, 1, 2, 2],
    [1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2],
    [2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1],
    [2, 1, 2, 5, 2, 1, 2, 2, 1, 2, 1, 2],
    [1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1],
    [2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2],
    [1, 5, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2],
    [1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2],
    [1, 2, 2, 1, 1, 5, 1, 2, 1, 2, 2, 1],
    [2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1],   /* 1931 */
    [2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2],
    [1, 2, 2, 1, 6, 1, 2, 1, 2, 1, 1, 2],
    [1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2],
    [1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1],
    [2, 1, 4, 1, 2, 1, 2, 1, 2, 2, 2, 1],
    [2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1],
    [2, 2, 1, 1, 2, 1, 4, 1, 2, 2, 1, 2],
    [2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2],
    [2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1],
    [2, 2, 1, 2, 2, 4, 1, 1, 2, 1, 2, 1],   /* 1941 */
    [2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 1, 2],
    [1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2],
    [1, 1, 2, 4, 1, 2, 1, 2, 2, 1, 2, 2],
    [1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2],
    [2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2],
    [2, 5, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2],
    [2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2],
    [2, 2, 1, 2, 1, 2, 3, 2, 1, 2, 1, 2],
    [2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1],
    [2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2],   /* 1951 */
    [1, 2, 1, 2, 4, 2, 1, 2, 1, 2, 1, 2],
    [1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2],
    [1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2],
    [2, 1, 4, 1, 1, 2, 1, 2, 1, 2, 2, 2],
    [1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2],
    [2, 1, 2, 1, 2, 1, 1, 5, 2, 1, 2, 2],
    [1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2],
    [1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1],
    [2, 1, 2, 1, 2, 5, 2, 1, 2, 1, 2, 1],
    [2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2],   /* 1961 */
    [1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1],
    [2, 1, 2, 3, 2, 1, 2, 1, 2, 2, 2, 1],
    [2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2],
    [1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2],
    [1, 2, 5, 2, 1, 1, 2, 1, 1, 2, 2, 1],
    [2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2],
    [1, 2, 2, 1, 2, 1, 5, 2, 1, 2, 1, 2],
    [1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1],
    [2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2],
    [1, 2, 1, 1, 5, 2, 1, 2, 2, 2, 1, 2],   /* 1971 */
    [1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1],
    [2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2, 1],
    [2, 2, 1, 5, 1, 2, 1, 1, 2, 2, 1, 2],
    [2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2],
    [2, 2, 1, 2, 1, 2, 1, 5, 2, 1, 1, 2],
    [2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1],
    [2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1],
    [2, 1, 1, 2, 1, 6, 1, 2, 2, 1, 2, 1],
    [2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2],
    [1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2],   /* 1981 */
    [2, 1, 2, 3, 2, 1, 1, 2, 2, 1, 2, 2],
    [2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2],
    [2, 1, 2, 2, 1, 1, 2, 1, 1, 5, 2, 2],
    [1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2],
    [1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1],
    [2, 1, 2, 2, 1, 5, 2, 2, 1, 2, 1, 2],
    [1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1],
    [2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2],
    [1, 2, 1, 1, 5, 1, 2, 1, 2, 2, 2, 2],
    [1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2],   /* 1991 */
    [1, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2],
    [1, 2, 5, 2, 1, 2, 1, 1, 2, 1, 2, 1],
    [2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2],
    [1, 2, 2, 1, 2, 2, 1, 5, 2, 1, 1, 2],
    [1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2],
    [1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1],
    [2, 1, 1, 2, 3, 2, 2, 1, 2, 2, 2, 1],
    [2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1],
    [2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1],
    [2, 2, 2, 3, 2, 1, 1, 2, 1, 2, 1, 2],   /* 2001 */
    [2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1],
    [2, 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2],
    [1, 5, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2],
    [1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1],
    [2, 1, 2, 1, 2, 1, 5, 2, 2, 1, 2, 2],
    [1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2],
    [2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2],
    [2, 2, 1, 1, 5, 1, 2, 1, 2, 1, 2, 2],
    [2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2],
    [2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1],   /* 2011 */
    [2, 1, 6, 2, 1, 2, 1, 1, 2, 1, 2, 1],
    [2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2],
    [1, 2, 1, 2, 1, 2, 1, 2, 5, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 1],
    [2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2],
    [2, 1, 1, 2, 3, 2, 1, 2, 1, 2, 2, 2],
    [1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2],
    [2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2],
    [2, 1, 2, 5, 2, 1, 1, 2, 1, 2, 1, 2],
    [1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1],   /* 2021 */
    [2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2],
    [1, 5, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1],
    [2, 1, 2, 1, 1, 5, 2, 1, 2, 2, 2, 1],
    [2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2],
    [1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2],
    [1, 2, 2, 1, 5, 1, 2, 1, 1, 2, 2, 1],
    [2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2],
    [1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1],
    [2, 1, 5, 2, 1, 2, 2, 1, 2, 1, 2, 1],   /* 2031 */
    [2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 5, 2],
    [1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1],
    [2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2],
    [2, 2, 1, 2, 1, 4, 1, 1, 2, 2, 1, 2],
    [2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2],
    [2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1],
    [2, 2, 1, 2, 5, 2, 1, 2, 1, 2, 1, 1],
    [2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1],
    [2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2],   /* 2041 */
    [1, 5, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2],
    [1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2]
];

let moon_Data=[
    ["20210101","1923","0929","17.8"],
    ["20210102","2029","1011","18.8"],
    ["20210103","2136","1047","19.8"],
    ["20210104","2243","1120","20.8"],
    ["20210105","2351","1151","21.8"],
    ["20210106","----","1220","22.8"],
    ["20210107","0059","1250","23.8"],
    ["20210108","0209","1322","24.8"],
    ["20210109","0320","1358","25.8"],
    ["20210110","0432","1440","26.8"],
    ["20210111","0544","1529","27.8"],
    ["20210112","0651","1626","28.8"],
    ["20210113","0751","1730","0.3"],
    ["20210114","0843","1837","1.3"],
    ["20210115","0925","1943","2.3"],
    ["20210116","1001","2048","3.3"],
    ["20210117","1031","2150","4.3"],
    ["20210118","1058","2249","5.3"],
    ["20210119","1123","2347","6.3"],
    ["20210120","1148","----","7.3"],
    ["20210121","1213","0044","8.3"],
    ["20210122","1240","0141","9.3"],
    ["20210123","1310","0239","10.3"],
    ["20210124","1344","0338","11.3"],
    ["20210125","1425","0438","12.3"],
    ["20210126","1513","0536","13.3"],
    ["20210127","1608","0631","14.3"],
    ["20210128","1710","0722","15.3"],
    ["20210129","1816","0807","16.3"],
    ["20210130","1925","0846","17.3"],
    ["20210131","2034","0921","18.3"],
    ["20210201","2143","0953","19.3"],
    ["20210202","2251","1023","20.3"],
    ["20210203","----","1053","21.3"],
    ["20210204","0001","1124","22.3"],
    ["20210205","0111","1158","23.3"],
    ["20210206","0222","1237","24.3"],
    ["20210207","0332","1322","25.3"],
    ["20210208","0439","1415","26.3"],
    ["20210209","0540","1515","27.3"],
    ["20210210","0634","1619","28.3"],
    ["20210211","0719","1726","29.3"],
    ["20210212","0757","1831","0.7"],
    ["20210213","0829","1935","1.7"],
    ["20210214","0858","2036","2.7"],
    ["20210215","0924","2135","3.7"],
    ["20210216","0948","2233","4.7"],
    ["20210217","1013","2330","5.7"],
    ["20210218","1039","----","6.7"],
    ["20210219","1108","0028","7.7"],
    ["20210220","1140","0126","8.7"],
    ["20210221","1217","0225","9.7"],
    ["20210222","1301","0323","10.7"],
    ["20210223","1353","0419","11.7"],
    ["20210224","1452","0512","12.7"],
    ["20210225","1556","0559","13.7"],
    ["20210226","1705","0641","14.7"],
    ["20210227","1816","0718","15.7"],
    ["20210228","1927","0751","16.7"],
    ["20210301","2038","0823","17.7"],
    ["20210302","2149","0853","18.7"],
    ["20210303","2301","0924","19.7"],
    ["20210304","----","0958","20.7"],
    ["20210305","0013","1036","21.7"],
    ["20210306","0125","1120","22.7"],
    ["20210307","0233","1210","23.7"],
    ["20210308","0336","1307","24.7"],
    ["20210309","0431","1409","25.7"],
    ["20210310","0517","1514","26.7"],
    ["20210311","0556","1619","27.7"],
    ["20210312","0630","1722","28.7"],
    ["20210313","0659","1824","0.1"],
    ["20210314","0725","1924","1.1"],
    ["20210315","0750","2022","2.1"],
    ["20210316","0815","2120","3.1"],
    ["20210317","0840","2218","4.1"],
    ["20210318","0907","2316","5.1"],
    ["20210319","0938","----","6.1"],
    ["20210320","1013","0014","7.1"],
    ["20210321","1053","0112","8.1"],
    ["20210322","1141","0209","9.1"],
    ["20210323","1235","0302","10.1"],
    ["20210324","1336","0350","11.1"],
    ["20210325","1442","0434","12.1"],
    ["20210326","1552","0512","13.1"],
    ["20210327","1703","0547","14.1"],
    ["20210328","1815","0619","15.1"],
    ["20210329","1928","0650","16.1"],
    ["20210330","2042","0721","17.1"],
    ["20210331","2157","0755","18.1"],
    ["20210401","2312","0832","19.1"],
    ["20210402","----","0915","20.1"],
    ["20210403","0024","1004","21.1"],
    ["20210404","0131","1101","22.1"],
    ["20210405","0229","1202","23.1"],
    ["20210406","0318","1307","24.1"],
    ["20210407","0359","1411","25.1"],
    ["20210408","0433","1515","26.1"],
    ["20210409","0503","1616","27.1"],
    ["20210410","0529","1716","28.1"],
    ["20210411","0554","1814","29.1"],
    ["20210412","0618","1912","0.4"],
    ["20210413","0643","2010","1.4"],
    ["20210414","0709","2108","2.4"],
    ["20210415","0738","2206","3.4"],
    ["20210416","0811","2305","4.4"],
    ["20210417","0849","----","5.4"],
    ["20210418","0933","0002","6.4"],
    ["20210419","1024","0055","7.4"],
    ["20210420","1122","0145","8.4"],
    ["20210421","1224","0229","9.4"],
    ["20210422","1330","0308","10.4"],
    ["20210423","1439","0343","11.4"],
    ["20210424","1549","0415","12.4"],
    ["20210425","1701","0446","13.4"],
    ["20210426","1815","0516","14.4"],
    ["20210427","1931","0549","15.4"],
    ["20210428","2048","0624","16.4"],
    ["20210429","2205","0705","17.4"],
    ["20210430","2317","0753","18.4"],
    ["20210501","----","0849","19.4"],
    ["20210502","0021","0951","20.4"],
    ["20210503","0115","1057","21.4"],
    ["20210504","0200","1203","22.4"],
    ["20210505","0236","1308","23.4"],
    ["20210506","0307","1410","24.4"],
    ["20210507","0335","1510","25.5"],
    ["20210508","0359","1608","26.4"],
    ["20210509","0423","1706","27.4"],
    ["20210510","0447","1803","28.4"],
    ["20210511","0513","1901","29.4"],
    ["20210512","0541","2000","0.7"],
    ["20210513","0612","2058","1.7"],
    ["20210514","0648","2156","2.7"],
    ["20210515","0730","2251","3.7"],
    ["20210516","0819","2342","4.7"],
    ["20210517","0914","----","5.7"],
    ["20210518","1013","0027","6.7"],
    ["20210519","1117","0107","7.7"],
    ["20210520","1222","0143","8.7"],
    ["20210521","1330","0215","9.7"],
    ["20210522","1438","0244","10.7"],
    ["20210523","1549","0314","11.7"],
    ["20210524","1702","0344","12.7"],
    ["20210525","1818","0417","13.7"],
    ["20210526","1936","0454","14.7"],
    ["20210527","2053","0539","15.7"],
    ["20210528","2204","0632","16.7"],
    ["20210529","2305","0733","17.7"],
    ["20210530","2355","0840","18.7"],
    ["20210531","----","0949","19.7"],
    ["20210601","0036","1056","20.7"],
    ["20210602","0110","1201","21.7"],
    ["20210603","0138","1302","22.7"],
    ["20210604","0204","1402","23.7"],
    ["20210605","0228","1500","24.7"],
    ["20210606","0252","1557","25.7"],
    ["20210607","0317","1655","26.7"],
    ["20210608","0344","1753","27.7"],
    ["20210609","0414","1852","28.7"],
    ["20210610","0448","1950","0.0"],
    ["20210611","0529","2047","1.0"],
    ["20210612","0615","2139","2.0"],
    ["20210613","0709","2226","3.0"],
    ["20210614","0807","2308","4.0"],
    ["20210615","0909","2344","5.0"],
    ["20210616","1014","----","6.0"],
    ["20210617","1119","0017","7.0"],
    ["20210618","1225","0046","8.0"],
    ["20210619","1332","0115","9.0"],
    ["20210620","1442","0143","10.0"],
    ["20210621","1554","0213","11.0"],
    ["20210622","1709","0247","12.0"],
    ["20210623","1826","0327","13.0"],
    ["20210624","1939","0415","14.0"],
    ["20210625","2046","0512","15.0"],
    ["20210626","2143","0617","16.0"],
    ["20210627","2229","0727","17.0"],
    ["20210628","2307","0837","18.0"],
    ["20210629","2339","0946","19.0"],
    ["20210630","----","1050","20.0"],
    ["20210701","0006","1152","21.0"],
    ["20210702","0032","1251","22.0"],
    ["20210703","0056","1349","23.0"],
    ["20210704","0120","1447","24.0"],
    ["20210705","0146","1545","25.0"],
    ["20210706","0215","1644","26.0"],
    ["20210707","0248","1743","27.0"],
    ["20210708","0326","1840","28.0"],
    ["20210709","0411","1934","29.0"],
    ["20210710","0503","2024","0.4"],
    ["20210711","0600","2108","1.4"],
    ["20210712","0702","2146","2.4"],
    ["20210713","0807","2219","3.4"],
    ["20210714","0912","2250","4.4"],
    ["20210715","1017","2318","5.4"],
    ["20210716","1123","2346","6.4"],
    ["20210717","1231","----","7.4"],
    ["20210718","1340","0014","8.4"],
    ["20210719","1452","0046","9.4"],
    ["20210720","1605","0122","10.4"],
    ["20210721","1718","0204","11.4"],
    ["20210722","1827","0256","12.4"],
    ["20210723","1928","0356","13.4"],
    ["20210724","2019","0504","14.4"],
    ["20210725","2101","0615","15.4"],
    ["20210726","2136","0725","16.4"],
    ["20210727","2206","0833","17.4"],
    ["20210728","2232","0937","18.4"],
    ["20210729","2257","1039","19.4"],
    ["20210730","2322","1138","20.4"],
    ["20210731","2347","1237","21.4"],
    ["20210801","----","1335","22.4"],
    ["20210802","0015","1434","23.4"],
    ["20210803","0046","1533","24.4"],
    ["20210804","0123","1631","25.4"],
    ["20210805","0205","1727","26.4"],
    ["20210806","0254","1818","27.4"],
    ["20210807","0350","1904","28.4"],
    ["20210808","0452","1945","29.4"],
    ["20210809","0556","2020","0.9"],
    ["20210810","0703","2052","1.9"],
    ["20210811","0809","2121","2.9"],
    ["20210812","0916","2149","3.9"],
    ["20210813","1023","2217","4.9"],
    ["20210814","1132","2247","5.9"],
    ["20210815","1242","2321","6.9"],
    ["20210816","1354","----","7.9"],
    ["20210817","1506","0001","8.9"],
    ["20210818","1615","0048","9.9"],
    ["20210819","1717","0143","10.9"],
    ["20210820","1811","0247","11.9"],
    ["20210821","1855","0356","12.9"],
    ["20210822","1933","0506","13.9"],
    ["20210823","2004","0614","14.9"],
    ["20210824","2032","0721","15.9"],
    ["20210825","2058","0824","16.9"],
    ["20210826","2122","0925","17.9"],
    ["20210827","2148","1025","18.9"],
    ["20210828","2215","1124","19.9"],
    ["20210829","2244","1223","20.9"],
    ["20210830","2318","1322","21.9"],
    ["20210831","2358","1421","22.9"],
    ["20210901","----","1517","23.9"],
    ["20210902","0044","1610","24.9"],
    ["20210903","0137","1658","25.9"],
    ["20210904","0237","1741","26.9"],
    ["20210905","0341","1818","27.9"],
    ["20210906","0447","1852","28.9"],
    ["20210907","0555","1922","0.5"],
    ["20210908","0703","1951","1.5"],
    ["20210909","0812","2019","2.5"],
    ["20210910","0922","2049","3.5"],
    ["20210911","1033","2122","4.5"],
    ["20210912","1146","2200","5.5"],
    ["20210913","1258","2244","6.5"],
    ["20210914","1408","2337","7.5"],
    ["20210915","1511","----","8.5"],
    ["20210916","1607","0037","9.9"],
    ["20210917","1653","0143","10.5"],
    ["20210918","1732","0252","11.5"],
    ["20210919","1804","0400","12.5"],
    ["20210920","1833","0506","13.5"],
    ["20210921","1859","0610","14.5"],
    ["20210922","1924","0712","15.5"],
    ["20210923","1949","0812","16.5"],
    ["20210924","2015","0912","17.5"],
    ["20210925","2043","1012","18.5"],
    ["20210926","2115","1111","19.5"],
    ["20210927","2152","1210","20.5"],
    ["20210928","2235","1307","21.5"],
    ["20210929","2325","1401","22.5"],
    ["20210930","----","1451","23.5"],
    ["20211001","0021","1535","24.5"],
    ["20211002","0123","1614","25.5"],
    ["20211003","0227","1649","26.5"],
    ["20211004","0334","1720","27.5"],
    ["20211005","0443","1749","28.5"],
    ["20211006","0552","1818","0.0"],
    ["20211007","0703","1848","1.0"],
    ["20211008","0816","1920","2.0"],
    ["20211009","0931","1957","3.0"],
    ["20211010","1046","2040","4.0"],
    ["20211011","1159","2131","5.0"],
    ["20211012","1307","2230","6.0"],
    ["20211013","1405","2335","7.0"],
    ["20211014","1454","----","8.0"],
    ["20211015","1534","0043","9.0"],
    ["20211016","1607","0151","10.0"],
    ["20211017","1636","0257","11.0"],
    ["20211018","1702","0400","12.0"],
    ["20211019","1727","0502","13.0"],
    ["20211020","1751","0602","14.0"],
    ["20211021","1816","0702","15.0"],
    ["20211022","1844","0801","16.0"],
    ["20211023","1914","0901","17.0"],
    ["20211024","1949","1001","18.0"],
    ["20211025","2030","1059","19.0"],
    ["20211026","2117","1154","20.0"],
    ["20211027","2210","1245","21.0"],
    ["20211028","2308","1331","22.0"],
    ["20211029","----","1411","23.0"],
    ["20211030","0010","1446","24.0"],
    ["20211031","0114","1518","25.0"],
    ["20211101","0221","1547","26.0"],
    ["20211102","0328","1615","27.0"],
    ["20211103","0438","1644","28.0"],
    ["20211104","0550","1715","29.0"],
    ["20211105","0705","1750","0.6"],
    ["20211106","0823","1831","1.6"],
    ["20211107","0940","1920","2.6"],
    ["20211108","1054","2018","3.6"],
    ["20211109","1158","2124","4.6"],
    ["20211110","1252","2233","5.6"],
    ["20211111","1335","2342","6.6"],
    ["20211112","1411","----","7.6"],
    ["20211113","1441","0049","8.6"],
    ["20211114","1508","0153","9.6"],
    ["20211115","1532","0255","10.6"],
    ["20211116","1556","0355","11.6"],
    ["20211117","1620","0454","12.6"],
    ["20211118","1646","0553","13.6"],
    ["20211119","1716","0653","14.6"],
    ["20211120","1749","0753","15.6"],
    ["20211121","1827","0851","16.6"],
    ["20211122","1912","0948","17.6"],
    ["20211123","2003","1041","18.6"],
    ["20211124","2059","1128","19.6"],
    ["20211125","2158","1210","20.6"],
    ["20211126","2301","1246","21.6"],
    ["20211127","----","1318","22.6"],
    ["20211128","0004","1347","23.6"],
    ["20211129","0109","1414","24.6"],
    ["20211130","0215","1441","25.6"],
    ["20211201","0324","1510","26.6"],
    ["20211202","0436","1542","27.6"],
    ["20211203","0552","1619","28.6"],
    ["20211204","0710","1704","0.2"],
    ["20211205","0828","1759","1.2"],
    ["20211206","0939","1903","2.2"],
    ["20211207","1041","2014","3.2"],
    ["20211208","1131","2127","4.2"],
    ["20211209","1211","2237","5.2"],
    ["20211210","1243","2344","6.2"],
    ["20211211","1312","----","7.2"],
    ["20211212","1337","0048","8.2"],
    ["20211213","1401","0149","9.2"],
    ["20211214","1425","0248","10.2"],
    ["20211215","1450","0347","11.2"],
    ["20211216","1518","0446","12.2"],
    ["20211217","1550","0545","13.2"],
    ["20211218","1626","0644","14.2"],
    ["20211219","1709","0742","15.2"],
    ["20211220","1758","0836","16.2"],
    ["20211221","1853","0926","17.2"],
    ["20211222","1952","1009","18.2"],
    ["20211223","2053","1047","19.2"],
    ["20211224","2155","1120","20.2"],
    ["20211225","2258","1149","21.2"],
    ["20211226","----","1216","22.2"],
    ["20211227","0002","1242","23.2"],
    ["20211228","0107","1309","24.2"],
    ["20211229","0215","1338","25.2"],
    ["20211230","0326","1411","26.2"],
    ["20211231","0441","1450","27.2"]
    ]
     
    
function myDate(year, month, day, leapMonth)
{
    this.year = year;
    this.month = month;
    this.day = day;
    this.leapMonth = leapMonth;
}

function lunarCalc(year, month, day, type, leapmonth)
{
    var solYear, solMonth, solDay;
    var lunYear, lunMonth, lunDay;
    var lunLeapMonth, lunMonthDay;
    var i, lunIndex;

    var solMonthDay = [31, 0, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

    /* range check */
    if (year < 1900 || year > 2040)
    {
        alert('1900년부터 2040년까지만 지원합니다');
        return;
    }

    /* 속도 개선을 위해 기준 일자를 여러개로 한다 */
    if (year >= 2000)
    {
        /* 기준일자 양력 2000년 1월 1일 (음력 1999년 11월 25일) */
        solYear = 2000;
        solMonth = 1;
        solDay = 1;
        lunYear = 1999;
        lunMonth = 11;
        lunDay = 25;
        lunLeapMonth = 0;

        solMonthDay[1] = 29;    /* 2000 년 2월 28일 */
        lunMonthDay = 30;   /* 1999년 11월 */
    }
    else if (year >= 1970)
    {
        /* 기준일자 양력 1970년 1월 1일 (음력 1969년 11월 24일) */
        solYear = 1970;
        solMonth = 1;
        solDay = 1;
        lunYear = 1969;
        lunMonth = 11;
        lunDay = 24;
        lunLeapMonth = 0;

        solMonthDay[1] = 28;    /* 1970 년 2월 28일 */
        lunMonthDay = 30;   /* 1969년 11월 */
    }
    else if (year >= 1940)
    {
        /* 기준일자 양력 1940년 1월 1일 (음력 1939년 11월 22일) */
        solYear = 1940;
        solMonth = 1;
        solDay = 1;
        lunYear = 1939;
        lunMonth = 11;
        lunDay = 22;
        lunLeapMonth = 0;

        solMonthDay[1] = 29;    /* 1940 년 2월 28일 */
        lunMonthDay = 29;   /* 1939년 11월 */
    }
    else
    {
        /* 기준일자 양력 1900년 1월 1일 (음력 1899년 12월 1일) */
        solYear = 1900;
        solMonth = 1;
        solDay = 1;
        lunYear = 1899;
        lunMonth = 12;
        lunDay = 1;
        lunLeapMonth = 0;

        solMonthDay[1] = 28;    /* 1900 년 2월 28일 */
        lunMonthDay = 30;   /* 1899년 12월 */
    }

    lunIndex = lunYear - 1899;

    while (true)
    {

        if (type == 1 &&
            year == solYear &&
            month == solMonth &&
            day == solDay)
        {
            return new myDate(lunYear, lunMonth, lunDay, lunLeapMonth);
        }
        else if (type == 2 &&
                year == lunYear &&
                month == lunMonth &&
                day == lunDay &&
                leapmonth == lunLeapMonth)
        {
            return new myDate(solYear, solMonth, solDay, 0);
        }

        /* add a day of solar calendar */
        if (solMonth == 12 && solDay == 31)
        {
            solYear++;
            solMonth = 1;
            solDay = 1;

            /* set monthDay of Feb */
            if (solYear % 400 == 0)
                solMonthDay[1] = 29;
            else if (solYear % 100 == 0)
                solMonthDay[1] = 28;
            else if (solYear % 4 == 0)
                solMonthDay[1] = 29;
            else
                solMonthDay[1] = 28;

        }
        else if (solMonthDay[solMonth - 1] == solDay)
        {
            solMonth++;
            solDay = 1;
        }
        else
            solDay++;

        /* add a day of lunar calendar */
        if (lunMonth == 12 &&
            ((lunarMonthTable[lunIndex][lunMonth - 1] == 1 && lunDay == 29) ||
            (lunarMonthTable[lunIndex][lunMonth - 1] == 2 && lunDay == 30)))
        {
            lunYear++;
            lunMonth = 1;
            lunDay = 1;

            if (lunYear > 2043) {
                alert("입력하신 달은 없습니다.");
                break;
            }

            lunIndex = lunYear - 1899;

            if (lunarMonthTable[lunIndex][lunMonth - 1] == 1)
                lunMonthDay = 29;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 2)
                lunMonthDay = 30;
        }
        else if (lunDay == lunMonthDay)
        {
            if (lunarMonthTable[lunIndex][lunMonth - 1] >= 3
                && lunLeapMonth == 0)
            {
                lunDay = 1;
                lunLeapMonth = 1;
            }
            else
            {
                lunMonth++;
                lunDay = 1;
                lunLeapMonth = 0;
            }

            if (lunarMonthTable[lunIndex][lunMonth - 1] == 1)
                lunMonthDay = 29;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 2)
                lunMonthDay = 30;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 3)
                lunMonthDay = 29;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 4 &&
                    lunLeapMonth == 0)
                lunMonthDay = 29;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 4 &&
                    lunLeapMonth == 1)
                lunMonthDay = 30;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 5 &&
                    lunLeapMonth == 0)
                lunMonthDay = 30;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 5 &&
                    lunLeapMonth == 1)
                    lunMonthDay = 29;
            else if (lunarMonthTable[lunIndex][lunMonth - 1] == 6)
                lunMonthDay = 30;
        }
        else
            lunDay++;
    }
}

function dayCalcDisplay(startYear,startMonth,startDay)
{
    if ( !startYear || startYear == 0 ||
            !startMonth || startMonth == 0 ||
            !startDay || startDay == 0 )
    {
        alert('날짜를 입력해주세요');
        return;
    }

    var solMonthDay = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

    if (startYear % 400 == 0 || ( startYear % 4 == 0 && startYear % 100 != 0 )) solMonthDay[1] += 1;


    if ( startMonth < 1 || startMonth > 12 ||
            startDay < 1 || startDay > solMonthDay[startMonth-1] ) {
        if ( solMonthDay[1] == 28 && startMonth == 2 && startDay > 28 )
            alert("윤년이 아닙니다. 다시 입력해주세요");
        else
            alert("날짜 범위를 벗어났습니다. 다시 입력해주세요");
        return;
    }

    var startDate = new Date(startYear, startMonth - 1, startDay);

    /* 양력/음력 변환 */
    var date = lunarCalc(startYear, startMonth, startDay, 1);

    return {
        year:date.year,
        month:date.month,
        day:date.day
    };
}

let moonriseT, moonsetT, lunAge;
const moonline=[0, 13.8, 27.6, 41.4, 55.2, 69, 82.8, 96.6, 110.4, 125, 104, 83.2, 62.4, 41.6, 20.8, 0, 15.625, 31.25, 46.875, 62.5, 78.125, 93.75, 109.375, 125, 107.2, 89.4, 71.6, 53.8, 36, 18.2];

function dateSetting(){
    var gYear=new Date().getFullYear();
    var gMonth=new Date().getMonth()+1+"";
    var gDay=new Date().getDate()+"";
    if(gMonth.length==1) gMonth="0"+gMonth;
    if(gDay.length==1) gDay="0"+gDay;
    return [gYear,gMonth,gDay]
}

function moonSetting(){
    let index=0;
    let today=dateSetting();
    for(let i=0;i<moon_Data.length;i++){
        if(moon_Data[i][0]==today[0]+today[1]+today[2])
            index=i;
    }
    moonriseT = moon_Data[index][1]
    moonsetT = moon_Data[index][2]
    moonrise.innerHTML=moonriseT[0]+moonriseT[1]+" : "+moonriseT[2]+moonriseT[3];
    moonset.innerHTML=moonsetT[0]+moonsetT[1]+" : "+moonsetT[2]+moonsetT[3];
    lunAge = moon_Data[index][3];
    lunAge=Math.round(lunAge);
    if(0<lunAge&&lunAge<=9){
        $('#moon').css({
            "border-right":moonline[lunAge]+"px solid #eee"
        });
    }
    else if(10<=lunAge&&lunAge<=15){
        $('#moon').css({
            "background":"#eee",
            "border-left":moonline[lunAge]+"px solid #333",
        });
    }
    else if(16<=lunAge&&lunAge<=23){
        $('#moon').css({
            "background":"#eee",
            "border-right":moonline[lunAge]+"px solid #333",
        });
    }
    else if(24<=lunAge&&lunAge<=29){
        $('#moon').css({
            "background":"#333",
            "border-left":moonline[lunAge]+"px solid #eee",
        });
    }
}

function moonSet(){
    $.ajax({
        url: "https://asia-northeast3-liquid-virtue-307900.cloudfunctions.net/todayMoon-1", // 클라이언트가 요청을 보낼 서버의 URL 주소
        type: "GET", // HTTP 요청 방식(GET, POST)
        dataType: "json", // 서버에서 보내줄 데이터의 타입
        success: function(data){
            let jsonObj = data;
            console.log(data);
            moonriseT = JSON.parse(jsonObj.body).moonrise;
            moonsetT = JSON.parse(jsonObj.body).moonset;
            moonrise.innerHTML=moonriseT[0]+moonriseT[1]+" : "+moonriseT[2]+moonriseT[3];
            moonset.innerHTML=moonsetT[0]+moonsetT[1]+" : "+moonsetT[2]+moonsetT[3];
        }
    });
}
function moonSet2(){
    $.ajax({
        url: "https://asia-northeast3-liquid-virtue-307900.cloudfunctions.net/todayMoon2-1", // 클라이언트가 요청을 보낼 서버의 URL 주소
        type: "GET", // HTTP 요청 방식(GET, POST)
        dataType: "json", // 서버에서 보내줄 데이터의 타입
        success: function(data){
            let jsonObj = data;
            console.log(data);
            lunAge = JSON.parse(jsonObj.body).lunAge;
            lunAge=Math.round(lunAge);
            if(0<lunAge&&lunAge<=9){
                $('#moon').css({
                    "border-right":moonline[lunAge]+"px solid #eee"
                });
            }
            else if(10<=lunAge&&lunAge<=15){
                $('#moon').css({
                    "background":"#eee",
                    "border-left":moonline[lunAge]+"px solid #333",
                });
            }
            else if(16<=lunAge&&lunAge<=23){
                $('#moon').css({
                    "background":"#eee",
                    "border-right":moonline[lunAge]+"px solid #333",
                });
            }
            else if(24<=lunAge&&lunAge<=29){
                $('#moon').css({
                    "background":"#333",
                    "border-left":moonline[lunAge]+"px solid #eee",
                });
            }
        }
    });
}
window.onload=function(){
    var gYear=new Date().getFullYear();
    var gMonth=new Date().getMonth()+1+"";
    var gDay=new Date().getDate()+"";
    var moon=document.getElementById("moon");
    var solar=document.getElementById("solar");
    var lunar=document.getElementById("lunar");
    var moonrise=document.getElementById("moonrise");
    var moonset=document.getElementById("moonset");
    var ymd=dayCalcDisplay(gYear,gMonth,gDay);
    ymd.month=ymd.month+""; ymd.day=ymd.day+"";
    if(ymd.month.length==1) ymd.month="0"+ymd.month;
    if(ymd.day.length==1) ymd.day="0"+ymd.day;
    if(gMonth.length==1) gMonth="0"+gMonth;
    if(gDay.length==1) gDay="0"+gDay;
    //moon.innerHTML="<img src=https://d5.co.kr/img/luna/2/s/"+ymd.day+".png />";
    solar.innerHTML=gYear+"년 "+gMonth+"월 "+gDay+"일";
    lunar.innerHTML=ymd.year+"년 "+ymd.month+"월 "+ymd.day+"일";
    //moonSet();
    //moonSet2();
    moonSetting();
}
